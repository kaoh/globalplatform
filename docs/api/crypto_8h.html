<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>globalplatform: crypto.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">globalplatform
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">crypto.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="types_8h_source.html">globalplatform/types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="library_8h_source.html">globalplatform/library.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="unicode_8h_source.html">globalplatform/unicode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">globalplatform/error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="security_8h_source.html">globalplatform/security.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for crypto.h:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8h__incl.png" border="0" usemap="#crypto_8h" alt=""/></div>
<map name="crypto_8h" id="crypto_8h">
<area shape="rect" id="node2" href="types_8h.html" title="globalplatform/types.h" alt="" coords="86,155,236,181"/>
<area shape="rect" id="node4" href="library_8h.html" title="globalplatform/library.h" alt="" coords="26,80,179,107"/>
<area shape="rect" id="node5" href="unicode_8h.html" title="globalplatform/unicode.h" alt="" coords="378,155,541,181"/>
<area shape="rect" id="node6" href="error_8h.html" title="globalplatform/error.h" alt="" coords="442,80,586,107"/>
<area shape="rect" id="node7" href="security_8h.html" title="globalplatform/security.h" alt="" coords="203,80,367,107"/>
<area shape="rect" id="node3" href="wintypes_8h.html" title="This keeps a list of Windows(R) types. " alt="" coords="118,229,204,256"/>
</map>
</div>
</div>
<p><a href="crypto_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9ea3ec462457548526dbf2282bc48645"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a9ea3ec462457548526dbf2282bc48645">calculate_CMAC_aes</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sMacKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> chainingValue[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[16])</td></tr>
<tr class="memdesc:a9ea3ec462457548526dbf2282bc48645"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a MAC for commands (APDUs) using CMAC AES. This is used by SCP03. The MAC for the message are the first 8 Bytes of mac. The next chainingValue are the full 16 Bytes of mac. Save this value for the next command MAC calculation.  <a href="#a9ea3ec462457548526dbf2282bc48645">More...</a><br /></td></tr>
<tr class="separator:a9ea3ec462457548526dbf2282bc48645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3030f0ef13b90d30c3f6073c9284cb8"><td class="memItemLeft" align="right" valign="top"><a id="ae3030f0ef13b90d30c3f6073c9284cb8"></a>
OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><b>get_key_data_field</b> (<a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *secInfo, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> keyData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> keyDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> keyType, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> isSensitive, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> keyDataField, <a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a> keyDataFieldLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> keyCheckValue[3])</td></tr>
<tr class="separator:ae3030f0ef13b90d30c3f6073c9284cb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb292b3131bef6cd64f430ab228703b"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#affb292b3131bef6cd64f430ab228703b">create_session_key_SCP01</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sessionKey[16])</td></tr>
<tr class="separator:affb292b3131bef6cd64f430ab228703b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd67bd366eeaacc169db17cd004f7d8"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8cd67bd366eeaacc169db17cd004f7d8">create_session_key_SCP02</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> constant[2], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sequenceCounter[2], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sessionKey[16])</td></tr>
<tr class="separator:a8cd67bd366eeaacc169db17cd004f7d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a444649bd7d4829f2b5a96a8baff8ec79"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a444649bd7d4829f2b5a96a8baff8ec79">calculate_rsa_signature</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> message, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> messageLength, <a class="el" href="types_8h.html#a88d56175458160f0a49ab97a45681f1f">OPGP_STRING</a> PEMKeyFileName, char *passPhrase, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> signature[128])</td></tr>
<tr class="separator:a444649bd7d4829f2b5a96a8baff8ec79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26f271e078a626cc682b2ba7f90dc6bb"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a26f271e078a626cc682b2ba7f90dc6bb">calculate_MAC</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> icv[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[8])</td></tr>
<tr class="separator:a26f271e078a626cc682b2ba7f90dc6bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae20ba4e0977c27b93ea191bdf579d910"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ae20ba4e0977c27b93ea191bdf579d910">calculate_card_cryptogram_SCP01</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENCSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardCryptogram[8])</td></tr>
<tr class="separator:ae20ba4e0977c27b93ea191bdf579d910"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c87adbc4bfb40dae6c1886cd5e1eae2"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a1c87adbc4bfb40dae6c1886cd5e1eae2">calculate_card_cryptogram_SCP02</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENCSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sequenceCounter[2], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[6], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardCryptogram[8])</td></tr>
<tr class="separator:a1c87adbc4bfb40dae6c1886cd5e1eae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be7da782783c4b51a4ebcf81f9eaeec"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a2be7da782783c4b51a4ebcf81f9eaeec">calculate_host_cryptogram_SCP01</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENCSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostCryptogram[8])</td></tr>
<tr class="separator:a2be7da782783c4b51a4ebcf81f9eaeec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b987c4652a34236acd7440970247059"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5b987c4652a34236acd7440970247059">calculate_host_cryptogram_SCP02</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENCSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sequenceCounter[2], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[6], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostCryptogram[8])</td></tr>
<tr class="separator:a5b987c4652a34236acd7440970247059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a367c2fd02a8da91c06a40e23e7d66539"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a367c2fd02a8da91c06a40e23e7d66539">create_session_key_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> derivationConstant, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sessionKey[16])</td></tr>
<tr class="separator:a367c2fd02a8da91c06a40e23e7d66539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3adea2cc12885f3eb635bc3398fad53"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ab3adea2cc12885f3eb635bc3398fad53">calculate_card_challenge_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_ENC[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> sequenceCounter[3], <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> invokingAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> invokingAIDLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8])</td></tr>
<tr class="separator:ab3adea2cc12885f3eb635bc3398fad53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a470048bcdfe2891d0ec8452a2dc5800d"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a470048bcdfe2891d0ec8452a2dc5800d">calculate_card_cryptogram_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_MACSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardCryptogram[8])</td></tr>
<tr class="separator:a470048bcdfe2891d0ec8452a2dc5800d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e8857931ddc9c83e223c5e5a4858e8"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a64e8857931ddc9c83e223c5e5a4858e8">calculate_host_cryptogram_SCP03</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> S_MACSessionKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> cardChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostChallenge[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hostCryptogram[8])</td></tr>
<tr class="separator:a64e8857931ddc9c83e223c5e5a4858e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87d1f55d8792acf1cd0c6cd920d2e068"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a87d1f55d8792acf1cd0c6cd920d2e068">wrap_command</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> apduCommand, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> apduCommandLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> wrappedApduCommand, <a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a> wrappedApduCommandLength, <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *secInfo)</td></tr>
<tr class="memdesc:a87d1f55d8792acf1cd0c6cd920d2e068"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wraps a command, i.e. encrypts and add the MAC to the APDU with the necessary security information according to secInfo.  <a href="#a87d1f55d8792acf1cd0c6cd920d2e068">More...</a><br /></td></tr>
<tr class="separator:a87d1f55d8792acf1cd0c6cd920d2e068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef8e8f1841e62331d666c0c24791123"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a7ef8e8f1841e62331d666c0c24791123">unwrap_command</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> apduCommand, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> apduCommandLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> responseData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> responseDataLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> unwrappedResponseData, <a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a> unwrappedResponseDataLength, <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *secInfo)</td></tr>
<tr class="memdesc:a7ef8e8f1841e62331d666c0c24791123"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unwraps a response, i.e. decrypts and checks the R-MAC of a response APDU with the necessary security information according to secInfo.  <a href="#a7ef8e8f1841e62331d666c0c24791123">More...</a><br /></td></tr>
<tr class="separator:a7ef8e8f1841e62331d666c0c24791123"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5692e1780d31ec244e060feeff7b391d"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5692e1780d31ec244e060feeff7b391d">GP211_check_R_MAC</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> apduCommand, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> apduCommandLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> responseData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> responseDataLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> unwrappedResponseApdu, <a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a> unwrappedResponseApduLength, <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *secInfo)</td></tr>
<tr class="memdesc:a5692e1780d31ec244e060feeff7b391d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks the R-MAC of an APDU with the necessary security information according to secInfo.  <a href="#a5692e1780d31ec244e060feeff7b391d">More...</a><br /></td></tr>
<tr class="separator:a5692e1780d31ec244e060feeff7b391d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4a14acc4ea37135486c0f5181ac5e91"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ad4a14acc4ea37135486c0f5181ac5e91">calculate_enc_ecb_two_key_triple_des</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *encryption, int *encryptionLength)</td></tr>
<tr class="separator:ad4a14acc4ea37135486c0f5181ac5e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad41f6e76f1750d5ebe905db02227dd4"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aad41f6e76f1750d5ebe905db02227dd4">validate_receipt</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> validationData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> validationDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receipt[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receiptKey[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> secureChannelProtocol)</td></tr>
<tr class="separator:aad41f6e76f1750d5ebe905db02227dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bb03b541572d0ac3ded85e298bf9944"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8bb03b541572d0ac3ded85e298bf9944">calculate_MAC_des_3des</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> _3des_key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> initialICV[8], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[8])</td></tr>
<tr class="separator:a8bb03b541572d0ac3ded85e298bf9944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a058255e16a6e2257918bb5f1509720b5"><td class="memItemLeft" align="right" valign="top"><a id="a058255e16a6e2257918bb5f1509720b5"></a>
OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><b>validate_install_receipt</b> (<a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> confirmationCounter, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> cardUniqueData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> cardUniqueDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receiptKey[16], <a class="el" href="structGP211__RECEIPT__DATA.html">GP211_RECEIPT_DATA</a> receiptData, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> executableLoadFileAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> executableLoadFileAIDLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> applicationAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> applicationAIDLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> secureChannelProtocol)</td></tr>
<tr class="separator:a058255e16a6e2257918bb5f1509720b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a963b64cf1bd940111cd78d3d6bd6cc"><td class="memItemLeft" align="right" valign="top"><a id="a0a963b64cf1bd940111cd78d3d6bd6cc"></a>
OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><b>validate_delete_receipt</b> (<a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> confirmationCounter, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> cardUniqueData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> cardUniqueDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receiptKey[16], <a class="el" href="structGP211__RECEIPT__DATA.html">GP211_RECEIPT_DATA</a> receiptData, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> AID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> AIDLengthv, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> secureChannelProtocol)</td></tr>
<tr class="separator:a0a963b64cf1bd940111cd78d3d6bd6cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8793c3e2da1e8627aeff3a8d0653f18"><td class="memItemLeft" align="right" valign="top"><a id="ae8793c3e2da1e8627aeff3a8d0653f18"></a>
OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><b>validate_load_receipt</b> (<a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> confirmationCounter, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> cardUniqueData, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> cardUniqueDataLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> receiptKey[16], <a class="el" href="structGP211__RECEIPT__DATA.html">GP211_RECEIPT_DATA</a> receiptData, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> executableLoadFileAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> executableLoadFileAIDLength, <a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> securityDomainAID, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> securityDomainAIDLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> secureChannelProtocol)</td></tr>
<tr class="separator:ae8793c3e2da1e8627aeff3a8d0653f18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52d9c606b6fbc1d281a10632a0770220"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a52d9c606b6fbc1d281a10632a0770220">read_public_rsa_key</a> (<a class="el" href="types_8h.html#a88d56175458160f0a49ab97a45681f1f">OPGP_STRING</a> PEMKeyFileName, char *passPhrase, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> rsaModulus[128], <a class="el" href="types_8h.html#a2a3e0cda5f1249bef6db47c5eb8e3813">LONG</a> *rsaExponent)</td></tr>
<tr class="memdesc:a52d9c606b6fbc1d281a10632a0770220"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a public RSA key from a file.  <a href="#a52d9c606b6fbc1d281a10632a0770220">More...</a><br /></td></tr>
<tr class="separator:a52d9c606b6fbc1d281a10632a0770220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8997f0b39dabb4ba9c6acb4a440e9f67"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a8997f0b39dabb4ba9c6acb4a440e9f67">calculate_sha256_hash</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> message, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hash[32])</td></tr>
<tr class="memdesc:a8997f0b39dabb4ba9c6acb4a440e9f67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a SHA-256 hash.  <a href="#a8997f0b39dabb4ba9c6acb4a440e9f67">More...</a><br /></td></tr>
<tr class="separator:a8997f0b39dabb4ba9c6acb4a440e9f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53ecdb550bff7f5e6a23822c77fc65e0"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a53ecdb550bff7f5e6a23822c77fc65e0">calculate_sha1_hash</a> (<a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a> message, <a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> hash[20])</td></tr>
<tr class="memdesc:a53ecdb550bff7f5e6a23822c77fc65e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a SHA-1 hash.  <a href="#a53ecdb550bff7f5e6a23822c77fc65e0">More...</a><br /></td></tr>
<tr class="separator:a53ecdb550bff7f5e6a23822c77fc65e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f25d6b21dd6c67339dac4af74fab8db"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a6f25d6b21dd6c67339dac4af74fab8db">calculate_MAC_right_des_3des</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> key[16], <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *message, int messageLength, <a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> mac[8])</td></tr>
<tr class="memdesc:a6f25d6b21dd6c67339dac4af74fab8db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a MAC using first DES and 3DES for the final round when the padding is applied.  <a href="#a6f25d6b21dd6c67339dac4af74fab8db">More...</a><br /></td></tr>
<tr class="separator:a6f25d6b21dd6c67339dac4af74fab8db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65751c4d1ab01f0650567caa11bb932c"><td class="memItemLeft" align="right" valign="top">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a65751c4d1ab01f0650567caa11bb932c">get_random</a> (<a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *random, int randomLength)</td></tr>
<tr class="separator:a65751c4d1ab01f0650567caa11bb932c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains internally used cryptographic related functionality. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab3adea2cc12885f3eb635bc3398fad53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3adea2cc12885f3eb635bc3398fad53">&#9670;&nbsp;</a></span>calculate_card_challenge_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_card_challenge_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENC</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sequenceCounter</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>invokingAID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>invokingAIDLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the card challenge when using pseudo-random challenge generation for SCP03. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENC</td><td>[in] The static S-ENC Key. </td></tr>
    <tr><td class="paramname">sequenceCounter</td><td>[in] The sequence counter. </td></tr>
    <tr><td class="paramname">invokingAID</td><td>The invoking AID byte buffer. </td></tr>
    <tr><td class="paramname">invokingAIDLength</td><td>The length of the invoking AID byte buffer. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[out] The calculated challenge. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="ae20ba4e0977c27b93ea191bdf579d910"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae20ba4e0977c27b93ea191bdf579d910">&#9670;&nbsp;</a></span>calculate_card_cryptogram_SCP01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_card_cryptogram_SCP01 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENCSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the card cryptogram for SCP01. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENCSessionKey</td><td>[in] The S-ENC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">cardCryptogram</td><td>[out] The calculated card cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a1c87adbc4bfb40dae6c1886cd5e1eae2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c87adbc4bfb40dae6c1886cd5e1eae2">&#9670;&nbsp;</a></span>calculate_card_cryptogram_SCP02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_card_cryptogram_SCP02 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENCSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sequenceCounter</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[6], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the card cryptogram for SCP02. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENCSessionKey</td><td>[in] The S-ENC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">sequenceCounter</td><td>[in] The sequence counter. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">cardCryptogram</td><td>[out] The calculated card cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a470048bcdfe2891d0ec8452a2dc5800d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a470048bcdfe2891d0ec8452a2dc5800d">&#9670;&nbsp;</a></span>calculate_card_cryptogram_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_card_cryptogram_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_MACSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the card cryptogram for SCP03. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_MACSessionKey</td><td>[in] The S-MAC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">cardCryptogram</td><td>[out] The calculated host cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a9ea3ec462457548526dbf2282bc48645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ea3ec462457548526dbf2282bc48645">&#9670;&nbsp;</a></span>calculate_CMAC_aes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_CMAC_aes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sMacKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>chainingValue</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a MAC for commands (APDUs) using CMAC AES. This is used by SCP03. The MAC for the message are the first 8 Bytes of mac. The next chainingValue are the full 16 Bytes of mac. Save this value for the next command MAC calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sMacKey</td><td>[in] The S-MAC key (session MAC key) to use for MAC generation. </td></tr>
    <tr><td class="paramname">message</td><td>[in] The message to generate the MAC for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">chainingValue</td><td>[in] The chaining value to use for the MAC generation. This is usually the full 16 Byte MAC generated for the last command or 16 bytes 0x00 for the first one (i.e. EXTERNAL AUTHENTICATE). </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The full 16 Byte MAC. Append the first 8 Bytes to the message. Save the full 16 Bytes for further MAC generation if needed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad4a14acc4ea37135486c0f5181ac5e91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4a14acc4ea37135486c0f5181ac5e91">&#9670;&nbsp;</a></span>calculate_enc_ecb_two_key_triple_des()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_enc_ecb_two_key_triple_des </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>encryption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>encryptionLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the encryption of a message in ECB mode with two key triple DES. Pads the message with 0x80 and additional 0x00 if message length is not a multiple of 8. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] A 3DES key used to encrypt. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to encrypt. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message. </td></tr>
    <tr><td class="paramname">*encryption</td><td>[out] The encryption. </td></tr>
    <tr><td class="paramname">*encryptionLength</td><td>[out] The length of the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STALTUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a2be7da782783c4b51a4ebcf81f9eaeec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be7da782783c4b51a4ebcf81f9eaeec">&#9670;&nbsp;</a></span>calculate_host_cryptogram_SCP01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_host_cryptogram_SCP01 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENCSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the host cryptogram for SCP01. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENCSessionKey</td><td>[in] The S-ENC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">hostCryptogram</td><td>[out] The calculated host cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a5b987c4652a34236acd7440970247059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b987c4652a34236acd7440970247059">&#9670;&nbsp;</a></span>calculate_host_cryptogram_SCP02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_host_cryptogram_SCP02 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_ENCSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sequenceCounter</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[6], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the host cryptogram for SCP02. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_ENCSessionKey</td><td>[in] The S-ENC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">sequenceCounter</td><td>[in] The sequence counter. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">hostCryptogram</td><td>[out] The calculated host cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a64e8857931ddc9c83e223c5e5a4858e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64e8857931ddc9c83e223c5e5a4858e8">&#9670;&nbsp;</a></span>calculate_host_cryptogram_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_host_cryptogram_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>S_MACSessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostCryptogram</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the host cryptogram for SCP03. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S_MACSessionKey</td><td>[in] The S-MAC Session Key for calculating the card cryptogram. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">hostCryptogram</td><td>[out] The calculated host cryptogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a26f271e078a626cc682b2ba7f90dc6bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f271e078a626cc682b2ba7f90dc6bb">&#9670;&nbsp;</a></span>calculate_MAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_MAC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sessionKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>icv</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates a message authentication code. Pads the message always with 0x80 and additional 0x00 until message length is a multiple of 8. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sessionKey</td><td>[in] A 3DES key used to sign. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to authenticate. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The message length. </td></tr>
    <tr><td class="paramname">icv</td><td>[in] The initial chaining vector. </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The calculated MAC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a8bb03b541572d0ac3ded85e298bf9944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bb03b541572d0ac3ded85e298bf9944">&#9670;&nbsp;</a></span>calculate_MAC_des_3des()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_MAC_des_3des </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>_3des_key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>initialICV</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates a message authentication code using the left half key of a two key 3DES key and the the full key for the final operation. Pads the message always with 0x80 and additional 0x00 until message length is a multiple of 8. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_3des_key</td><td>[in] A 3DES key used to sign. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to authenticate. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The message length. </td></tr>
    <tr><td class="paramname">initialICV</td><td>[in] The initial chaining vector. </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The calculated MAC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a6f25d6b21dd6c67339dac4af74fab8db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f25d6b21dd6c67339dac4af74fab8db">&#9670;&nbsp;</a></span>calculate_MAC_right_des_3des()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_MAC_right_des_3des </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>mac</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a MAC using first DES and 3DES for the final round when the padding is applied. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] A 3DES key used to sign. For DES the right half of the key is used. </td></tr>
    <tr><td class="paramname">*message</td><td>[in] The message to authenticate. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The message length. </td></tr>
    <tr><td class="paramname">mac</td><td>[out] The calculated MAC. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a444649bd7d4829f2b5a96a8baff8ec79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a444649bd7d4829f2b5a96a8baff8ec79">&#9670;&nbsp;</a></span>calculate_rsa_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_rsa_signature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a88d56175458160f0a49ab97a45681f1f">OPGP_STRING</a>&#160;</td>
          <td class="paramname"><em>PEMKeyFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>passPhrase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>signature</em>[128]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates a RSA signature using SHA-1 and PKCS#1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>[in] The message to generate the signature for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message buffer. </td></tr>
    <tr><td class="paramname">PEMKeyFileName</td><td>[in] A PEM file name with the private RSA key. </td></tr>
    <tr><td class="paramname">*passPhrase</td><td>[in] The passphrase. Must be an ASCII string. </td></tr>
    <tr><td class="paramname">signature</td><td>The calculated signature. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a53ecdb550bff7f5e6a23822c77fc65e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53ecdb550bff7f5e6a23822c77fc65e0">&#9670;&nbsp;</a></span>calculate_sha1_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_sha1_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hash</em>[20]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a SHA-1 hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>[in] The message to generate the hash for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message buffer. </td></tr>
    <tr><td class="paramname">hash</td><td>[out] The calculated hash. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8997f0b39dabb4ba9c6acb4a440e9f67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8997f0b39dabb4ba9c6acb4a440e9f67">&#9670;&nbsp;</a></span>calculate_sha256_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> calculate_sha256_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hash</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a SHA-256 hash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>[in] The message to generate the hash for. </td></tr>
    <tr><td class="paramname">messageLength</td><td>[in] The length of the message buffer. </td></tr>
    <tr><td class="paramname">hash</td><td>[out] The calculated hash. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="affb292b3131bef6cd64f430ab228703b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affb292b3131bef6cd64f430ab228703b">&#9670;&nbsp;</a></span>create_session_key_SCP01()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> create_session_key_SCP01 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sessionKey</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates the session key for SCP01. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] The Secure Channel Encryption Key or Secure Channel Message Authentication Code Key for calculating the corresponding session key. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">sessionKey</td><td>[out] The calculated 3DES session key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a8cd67bd366eeaacc169db17cd004f7d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cd67bd366eeaacc169db17cd004f7d8">&#9670;&nbsp;</a></span>create_session_key_SCP02()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> create_session_key_SCP02 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>constant</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sequenceCounter</em>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sessionKey</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates the session key for SCP02. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] The Secure Channel Encryption Key or Secure Channel Message Authentication Code Key or Data Encryption Key for calculating the corresponding session key. </td></tr>
    <tr><td class="paramname">constant</td><td>[in] The constant for the corresponding session key. </td></tr>
    <tr><td class="paramname">sequenceCounter</td><td>[in] The sequence counter. </td></tr>
    <tr><td class="paramname">sessionKey</td><td>[out] The calculated 3DES session key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a367c2fd02a8da91c06a40e23e7d66539"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a367c2fd02a8da91c06a40e23e7d66539">&#9670;&nbsp;</a></span>create_session_key_SCP03()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> create_session_key_SCP03 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>key</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>derivationConstant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>cardChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>hostChallenge</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>sessionKey</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an AES-128 session key for SCP03. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>[in] The Secure Channel Encryption Key or Secure Channel Message Authentication Code Key for calculating the corresponding session key. </td></tr>
    <tr><td class="paramname">derivationConstant</td><td>[in] The derivation constant, as defined in "Table 4-1: Data derivation constants" of SCP03. </td></tr>
    <tr><td class="paramname">cardChallenge</td><td>[in] The card challenge. </td></tr>
    <tr><td class="paramname">hostChallenge</td><td>[in] The host challenge. </td></tr>
    <tr><td class="paramname">sessionKey</td><td>[out] The calculated AES session key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a65751c4d1ab01f0650567caa11bb932c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65751c4d1ab01f0650567caa11bb932c">&#9670;&nbsp;</a></span>get_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> get_random </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>randomLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*random</td><td>[out] The random to generate. </td></tr>
    <tr><td class="paramname">randomLength</td><td>[in] The random length to generate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a5692e1780d31ec244e060feeff7b391d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5692e1780d31ec244e060feeff7b391d">&#9670;&nbsp;</a></span>GP211_check_R_MAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> GP211_check_R_MAC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>apduCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>apduCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>responseApdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>responseApduLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>unwrappedResponseApdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a>&#160;</td>
          <td class="paramname"><em>unwrappedResponseApduLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *&#160;</td>
          <td class="paramname"><em>secInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks the R-MAC of an APDU with the necessary security information according to secInfo. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apduCommand</td><td>[in] The command APDU. </td></tr>
    <tr><td class="paramname">apduCommandLength</td><td>[in] The length of the command APDU. </td></tr>
    <tr><td class="paramname">responseApdu</td><td>[in] The response APDU. </td></tr>
    <tr><td class="paramname">responseApduLength</td><td>[in] The length of the response APDU. </td></tr>
    <tr><td class="paramname">unwrappedResponseApdu</td><td>[out] The buffer for the unwrapped response APDU. </td></tr>
    <tr><td class="paramname">unwrappedResponseApduLength</td><td>[in, out] The available and returned modified length of the unwrappedResponseAPDU buffer. </td></tr>
    <tr><td class="paramname">*secInfo</td><td>[in] The pointer to the <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> structure returned by <a class="el" href="globalplatform_8h.html#a04ec0caaa3d78ae71bde0843f626b2ca" title="GlobalPlatform2.1.1: Mutual authentication. ">GP211_mutual_authentication()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a52d9c606b6fbc1d281a10632a0770220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52d9c606b6fbc1d281a10632a0770220">&#9670;&nbsp;</a></span>read_public_rsa_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> read_public_rsa_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a88d56175458160f0a49ab97a45681f1f">OPGP_STRING</a>&#160;</td>
          <td class="paramname"><em>PEMKeyFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>passPhrase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>rsaModulus</em>[128], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a2a3e0cda5f1249bef6db47c5eb8e3813">LONG</a> *&#160;</td>
          <td class="paramname"><em>rsaExponent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a public RSA key from a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PEMKeyFileName</td><td>[in] The key file. </td></tr>
    <tr><td class="paramname">*passPhrase</td><td>[in] The passphrase. Must be an ASCII string. </td></tr>
    <tr><td class="paramname">rsaModulus</td><td>[out] The RSA modulus. </td></tr>
    <tr><td class="paramname">rsaExponent</td><td>[out] The RSA exponent. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7ef8e8f1841e62331d666c0c24791123"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ef8e8f1841e62331d666c0c24791123">&#9670;&nbsp;</a></span>unwrap_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> unwrap_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>apduCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>apduCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>responseApdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>responseApduLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>unwrappedResponseApdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a>&#160;</td>
          <td class="paramname"><em>unwrappedResponseApduLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *&#160;</td>
          <td class="paramname"><em>secInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unwraps a response, i.e. decrypts and checks the R-MAC of a response APDU with the necessary security information according to secInfo. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apduCommand</td><td>[in] The command APDU. </td></tr>
    <tr><td class="paramname">apduCommandLength</td><td>[in] The length of the command APDU. </td></tr>
    <tr><td class="paramname">responseApdu</td><td>[in] The response data. </td></tr>
    <tr><td class="paramname">responseApduLength</td><td>[in] The length of the response data. </td></tr>
    <tr><td class="paramname">unwrappedResponseApdu</td><td>[out] The buffer for the unwrapped response APDU. </td></tr>
    <tr><td class="paramname">unwrappedResponseApduLength</td><td>[in, out] The available and returned modified length of the unwrappedResponseAPDU buffer. </td></tr>
    <tr><td class="paramname">*secInfo</td><td>[in] The pointer to the <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> structure returned by <a class="el" href="globalplatform_8h.html#a04ec0caaa3d78ae71bde0843f626b2ca" title="GlobalPlatform2.1.1: Mutual authentication. ">GP211_mutual_authentication()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="aad41f6e76f1750d5ebe905db02227dd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad41f6e76f1750d5ebe905db02227dd4">&#9670;&nbsp;</a></span>validate_receipt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> validate_receipt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>validationData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>validationDataLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>receipt</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>receiptKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>secureChannelProtocol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>GlobalPlatform2.1.1: Validates a Receipt. Returns OPGP_ERROR_STATUS_SUCCESS if the receipt is valid. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">validationData</td><td>[in] The data used to validate the returned receipt. </td></tr>
    <tr><td class="paramname">validationDataLength</td><td>[in] The length of the validationData buffer. </td></tr>
    <tr><td class="paramname">receipt</td><td>[in] The receipt. </td></tr>
    <tr><td class="paramname">receiptKey</td><td>[in] The 3DES key to generate the receipt. </td></tr>
    <tr><td class="paramname">secureChannelProtocol</td><td>[in] The Secure Channel Protocol. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
<a id="a87d1f55d8792acf1cd0c6cd920d2e068"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87d1f55d8792acf1cd0c6cd920d2e068">&#9670;&nbsp;</a></span>wrap_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OPGP_NO_API <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> wrap_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>apduCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>&#160;</td>
          <td class="paramname"><em>apduCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a4bd6347187b497cd4ef537426e8b6329">PBYTE</a>&#160;</td>
          <td class="paramname"><em>wrappedApduCommand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a5275a4ecdc7e43cac83633d4df04bb88">PDWORD</a>&#160;</td>
          <td class="paramname"><em>wrappedApduCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> *&#160;</td>
          <td class="paramname"><em>secInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wraps a command, i.e. encrypts and add the MAC to the APDU with the necessary security information according to secInfo. </p>
<p>Wraps a APDU with the necessary security information according to secInfo. The wrappedapduCommand must be a buffer with enough space for the potential added padding for the encryption and the MAC. The maximum possible extra space to the apduCommandLength is 8 bytes for the MAC plus 7 bytes for padding and one Lc byte in the encryption process. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apduCommand</td><td>[in] The command APDU. </td></tr>
    <tr><td class="paramname">apduCommandLength</td><td>[in] The length of the command APDU. </td></tr>
    <tr><td class="paramname">wrappedApduCommand</td><td>[out] The buffer for the wrapped APDU command. </td></tr>
    <tr><td class="paramname">wrappedApduCommandLength</td><td>[in, out] The available and returned modified length of the wrappedApduCommand buffer. </td></tr>
    <tr><td class="paramname">*secInfo</td><td>[in] The pointer to the <a class="el" href="structGP211__SECURITY__INFO.html">GP211_SECURITY_INFO</a> structure returned by <a class="el" href="globalplatform_8h.html#a04ec0caaa3d78ae71bde0843f626b2ca" title="GlobalPlatform2.1.1: Mutual authentication. ">GP211_mutual_authentication()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct with error status OPGP_ERROR_STATUS_SUCCESS if no error occurs, otherwise error code and error message are contained in the <a class="el" href="structOPGP__ERROR__STATUS.html">OPGP_ERROR_STATUS</a> struct </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
